<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Configuration - Timetable Planner</title>

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;600;700&family=Work+Sans:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Stylesheet -->
    <link rel="stylesheet" href="css/styles.css" />

    <!-- AWS Services -->
    <script src="js/aws-config.js"></script>
    <script src="js/aws-auth.js"></script>
    <script src="js/aws-api.js"></script>
    <script src="js/aws-storage.js"></script>

    <!-- Shared utilities -->
    <script src="js/shared.js"></script>
  </head>
  <body>
    <!-- User Info Bar -->
    <div class="user-info">
      <span class="user-role">Administrator</span>
      <button class="logout-btn" onclick="handleLogout()">Logout</button>
    </div>

    <div class="container container--narrow">
      <!-- Back Link -->
      <a href="admin.html" class="back-link">
        <span>‚Üê</span> Back to Timetable
      </a>

      <!-- Page Header -->
      <div class="page-header">
        <h1>Configuration</h1>
        <p>Manage accounts, themes, and organization branding</p>
      </div>

      <!-- Configuration Grid -->
      <div class="config-grid">
        <!-- Account Management Panel -->
        <div class="panel">
          <h2 class="panel-title">
            <span class="panel-icon">üë§</span>
            Account Management
          </h2>
          <p class="panel-description">
            Create and manage user accounts for your organization.
          </p>

          <!-- Tab Navigation -->
          <div class="tab-nav">
            <button class="tab-btn active" data-tab="existing-accounts">Existing Accounts</button>
            <button class="tab-btn" data-tab="create-account">Create Account</button>
          </div>

          <!-- Existing Accounts Tab -->
          <div class="tab-content active" id="existing-accounts">
            <div class="account-list" id="accountListContainer">
              <div class="account-item">
                <div class="account-info">Loading accounts...</div>
              </div>
            </div>
          </div>

          <!-- Create Account Tab -->
          <div class="tab-content" id="create-account">
            <div class="form-group">
              <label for="new-email">Email Address</label>
              <input type="email" id="new-email" placeholder="user@yourschool.com" />
            </div>

            <div class="form-group">
              <label for="new-password">Password</label>
              <input type="password" id="new-password" placeholder="Minimum 6 characters" />
            </div>

            <div class="form-group">
              <label for="new-role">Role</label>
              <select id="new-role">
                <option value="viewer">ESO Staff (Viewer)</option>
                <option value="admin">Leadership (Administrator)</option>
              </select>
            </div>

            <button class="btn btn-primary btn-full" id="create-account-btn">
              Create Account
            </button>

            <div class="status-message" id="account-status"></div>
          </div>
        </div>

        <!-- Theme Customization Panel -->
        <div class="panel">
          <h2 class="panel-title">
            <span class="panel-icon">üé®</span>
            Theme Customization
          </h2>
          <p class="panel-description">
            Customize the color scheme to match your organization branding.
          </p>

          <!-- Color Pickers -->
          <div class="color-picker-row">
            <label for="color-primary">Primary Color</label>
            <div class="color-preview">
              <input type="color" id="color-primary" value="#2c5f4f" />
              <span class="color-hex" id="primary-hex">#2c5f4f</span>
            </div>
          </div>

          <div class="color-picker-row">
            <label for="color-primary-light">Primary Light</label>
            <div class="color-preview">
              <input type="color" id="color-primary-light" value="#3d7861" />
              <span class="color-hex" id="primary-light-hex">#3d7861</span>
            </div>
          </div>

          <div class="color-picker-row">
            <label for="color-accent">Accent Color</label>
            <div class="color-preview">
              <input type="color" id="color-accent" value="#d4a574" />
              <span class="color-hex" id="accent-hex">#d4a574</span>
            </div>
          </div>

          <!-- Preset Colors -->
          <div class="divider"></div>
          <label>Preset Color Schemes</label>
          <div class="preset-colors">
            <button class="preset-color selected" data-color="#2c5f4f" style="background: #2c5f4f" title="Forest Green"></button>
            <button class="preset-color" data-color="#1e40af" style="background: #1e40af" title="Royal Blue"></button>
            <button class="preset-color" data-color="#7c3aed" style="background: #7c3aed" title="Purple"></button>
            <button class="preset-color" data-color="#b91c1c" style="background: #b91c1c" title="Crimson"></button>
            <button class="preset-color" data-color="#0891b2" style="background: #0891b2" title="Cyan"></button>
            <button class="preset-color" data-color="#4f46e5" style="background: #4f46e5" title="Indigo"></button>
            <button class="preset-color" data-color="#059669" style="background: #059669" title="Emerald"></button>
            <button class="preset-color" data-color="#ca8a04" style="background: #ca8a04" title="Amber"></button>
          </div>

          <!-- Theme Preview -->
          <div class="theme-preview">
            <div class="theme-preview-title">Preview</div>
            <div class="theme-preview-bar" id="theme-preview-bar"></div>
            <div class="theme-preview-buttons">
              <button class="theme-preview-btn" id="preview-btn-primary" style="background: var(--primary); color: white">Primary</button>
              <button class="theme-preview-btn" id="preview-btn-light" style="background: var(--primary-light); color: white">Light</button>
              <button class="theme-preview-btn" id="preview-btn-accent" style="background: var(--accent); color: white">Accent</button>
            </div>
          </div>

          <div class="btn-group">
            <button class="btn btn-primary" id="save-colors-btn">Save Theme</button>
            <button class="btn btn-secondary" id="reset-colors-btn">Reset to Default</button>
          </div>
        </div>

        <!-- Logo Management Panel -->
        <div class="panel panel-full">
          <h2 class="panel-title">
            <span class="panel-icon">üè¢</span>
            Organization Logo
          </h2>
          <p class="panel-description">
            Upload your organization logo to display on timetables and exports.
          </p>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem">
            <!-- Upload Section -->
            <div>
              <div class="form-group">
                <label for="logo-upload">Upload Logo</label>
                <input type="file" id="logo-upload" accept="image/*" />
                <p class="form-hint">Recommended: PNG or SVG, max 500KB</p>
              </div>

              <div class="form-group">
                <label for="logo-position">Logo Position</label>
                <select id="logo-position">
                  <option value="header-left">Header - Left</option>
                  <option value="header-center">Header - Center</option>
                  <option value="header-right">Header - Right</option>
                </select>
              </div>

              <div class="form-group">
                <label for="logo-size">Logo Size</label>
                <select id="logo-size">
                  <option value="small">Small</option>
                  <option value="medium" selected>Medium</option>
                  <option value="large">Large</option>
                </select>
              </div>

              <div class="btn-group">
                <button class="btn btn-primary" id="save-logo-btn">Save Logo Settings</button>
                <button class="btn btn-danger" id="remove-logo-btn">Remove Logo</button>
              </div>
            </div>

            <!-- Preview Section -->
            <div>
              <label>Current Logo</label>
              <div class="logo-preview-container">
                <div class="logo-placeholder" id="logo-placeholder">
                  <span class="icon">üè¢</span>
                  No logo uploaded
                </div>
                <img id="logo-preview" class="logo-preview" style="display: none" alt="Organization logo preview" />
              </div>
            </div>
          </div>

          <div class="status-message" id="logo-status"></div>
        </div>

        <!-- Danger Zone Panel -->
        <div class="panel panel-full">
          <h2 class="panel-title" style="color: var(--error)">
            <span class="panel-icon">‚ö†Ô∏è</span>
            Danger Zone
          </h2>

          <div class="warning-box">
            <div class="warning-title">
              <span>‚ö†Ô∏è</span> Warning
            </div>
            <p>These actions cannot be undone. Please proceed with caution.</p>
          </div>

          <div class="btn-group">
            <button class="btn btn-danger" onclick="if(confirm('Are you sure you want to clear all timetable data? This cannot be undone.')) { database.ref('timetable/current').remove().then(() => showNotification('Timetable data cleared')).catch(e => showNotification('Error: ' + e.message, true)); }">
              Clear All Timetable Data
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner">
        <div class="spinner"></div>
        <p>Please wait...</p>
      </div>
    </div>

    <!-- Config JavaScript -->
    <script src="js/config.js"></script>
  </body>
</html>
